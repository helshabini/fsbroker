[FSBroker] Debug logging ENABLED (compiled with 'fsbroker_debug' tag)
=== RUN   TestNewEventStack
--- PASS: TestNewEventStack (0.00s)
=== RUN   TestEventStack_PushAndLen
--- PASS: TestEventStack_PushAndLen (0.00s)
=== RUN   TestEventStack_Pop
--- PASS: TestEventStack_Pop (0.00s)
=== RUN   TestEventStack_List
--- PASS: TestEventStack_List (0.00s)
=== RUN   TestEventStack_Delete
--- PASS: TestEventStack_Delete (0.00s)
=== RUN   TestEventStack_Clear
--- PASS: TestEventStack_Clear (0.00s)
=== RUN   TestEventStack_Concurrency
    eventstack_test.go:265: Stack length after concurrent pops/deletes: 2808 (popped: 1300, potentially deleted: 892)
--- PASS: TestEventStack_Concurrency (0.02s)
=== RUN   TestNewFSAction
--- PASS: TestNewFSAction (0.00s)
=== RUN   TestFromFSEvent
--- PASS: TestFromFSEvent (0.00s)
=== RUN   TestMapOpToOpType
=== RUN   TestMapOpToOpType/Create
=== RUN   TestMapOpToOpType/Write
=== RUN   TestMapOpToOpType/Remove
=== RUN   TestMapOpToOpType/Rename
=== RUN   TestMapOpToOpType/Chmod
=== RUN   TestMapOpToOpType/Write+Chmod
=== RUN   TestMapOpToOpType/Create+Write
=== RUN   TestMapOpToOpType/Remove+Rename
=== RUN   TestMapOpToOpType/Unknown_(0)
=== RUN   TestMapOpToOpType/Unknown_high_bit
--- PASS: TestMapOpToOpType (0.00s)
    --- PASS: TestMapOpToOpType/Create (0.00s)
    --- PASS: TestMapOpToOpType/Write (0.00s)
    --- PASS: TestMapOpToOpType/Remove (0.00s)
    --- PASS: TestMapOpToOpType/Rename (0.00s)
    --- PASS: TestMapOpToOpType/Chmod (0.00s)
    --- PASS: TestMapOpToOpType/Write+Chmod (0.00s)
    --- PASS: TestMapOpToOpType/Create+Write (0.00s)
    --- PASS: TestMapOpToOpType/Remove+Rename (0.00s)
    --- PASS: TestMapOpToOpType/Unknown_(0) (0.00s)
    --- PASS: TestMapOpToOpType/Unknown_high_bit (0.00s)
=== RUN   TestDefaultFSConfig
--- PASS: TestDefaultFSConfig (0.00s)
=== RUN   TestNewFSEvent
=== RUN   TestNewFSEvent/Create_Event
=== RUN   TestNewFSEvent/Write_Event
=== RUN   TestNewFSEvent/Remove_Event
=== RUN   TestNewFSEvent/Rename_Event
=== RUN   TestNewFSEvent/Chmod_Event
=== RUN   TestNewFSEvent/Combined_Write+Chmod
--- PASS: TestNewFSEvent (0.00s)
    --- PASS: TestNewFSEvent/Create_Event (0.00s)
    --- PASS: TestNewFSEvent/Write_Event (0.00s)
    --- PASS: TestNewFSEvent/Remove_Event (0.00s)
    --- PASS: TestNewFSEvent/Rename_Event (0.00s)
    --- PASS: TestNewFSEvent/Chmod_Event (0.00s)
    --- PASS: TestNewFSEvent/Combined_Write+Chmod (0.00s)
=== RUN   TestFSInfo_IsDir
=== RUN   TestFSInfo_IsDir/Directory_Mode
=== RUN   TestFSInfo_IsDir/Regular_File_Mode
=== RUN   TestFSInfo_IsDir/Symlink_Mode_(not_dir)
--- PASS: TestFSInfo_IsDir (0.00s)
    --- PASS: TestFSInfo_IsDir/Directory_Mode (0.00s)
    --- PASS: TestFSInfo_IsDir/Regular_File_Mode (0.00s)
    --- PASS: TestFSInfo_IsDir/Symlink_Mode_(not_dir) (0.00s)
=== RUN   TestFSInfo_String
--- PASS: TestFSInfo_String (0.00s)
=== RUN   TestNewFSMap
--- PASS: TestNewFSMap (0.00s)
=== RUN   TestFSMap_SetAndGet
--- PASS: TestFSMap_SetAndGet (0.00s)
=== RUN   TestFSMap_Delete
--- PASS: TestFSMap_Delete (0.00s)
=== RUN   TestFSMap_Iterate
--- PASS: TestFSMap_Iterate (0.00s)
=== RUN   TestFSMap_Concurrency
    fsmap_test.go:366: Delete attempts: 625, Successes: 625, Failures (e.g. not found): 0
    fsmap_test.go:379: Final size after concurrent ops: 4375
--- PASS: TestFSMap_Concurrency (0.05s)
=== RUN   TestFSBrokerIntegration
=== RUN   TestFSBrokerIntegration/CreateEmptyFile
time=2025-05-04T16:56:47.973+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:56:48.074+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt
time=2025-05-04T16:56:48.074+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:48.074+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:48.974+03:00 level=DEBUG msg="Action: " id=63937982 action="&{Type:Create Timestamp:2025-05-04 16:56:48.074842 +0300 EEST m=+0.166608542 Subject:Id: 63937982, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt, Mode: 644 Events:[0x1400025a0c0] Properties:map[]}"
time=2025-05-04T16:56:48.975+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:328: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3179499908/watch/empty_file.txt, Props=map[]
    fsbroker_test.go:331: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/CreateNonEmptyFile
time=2025-05-04T16:56:49.178+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:56:49.279+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt
time=2025-05-04T16:56:49.279+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:49.279+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Action: " id=63937985 action="&{Type:Create Timestamp:2025-05-04 16:56:49.27919 +0300 EEST m=+1.370955959 Subject:Id: 63937985, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt, Mode: 644 Events:[0x1400062b300] Properties:map[]}"
time=2025-05-04T16:56:50.179+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:345: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1863918449/watch/non_empty_file.txt, Props=map[]
    fsbroker_test.go:349: Correctly received no non-NoOp action or error within 500ms
    fsbroker_test.go:352: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/ModifyFile
time=2025-05-04T16:56:50.883+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:56:50.984+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:50.984+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:50.984+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Action: " id=63937989 action="&{Type:Create Timestamp:2025-05-04 16:56:50.984388 +0300 EEST m=+3.076155251 Subject:Id: 63937989, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt, Mode: 644 Events:[0x1400062b400] Properties:map[]}"
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:364: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt, Props=map[]
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:56:51.884+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Stating event file" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Write: Found watchmap entry. This is a normal write" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Write: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Write: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Action: " id=63937989 action="&{Type:Write Timestamp:2025-05-04 16:56:51.884523 +0300 EEST m=+3.976290417 Subject:Id: 63937989, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt, Mode: 644 Events:[0x1400007e080] Properties:map[]}"
time=2025-05-04T16:56:52.884+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:378: Received expected action: Type=Write, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3167132682/watch/modify_file.txt, Props=map[]
    fsbroker_test.go:381: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/ClearFile
time=2025-05-04T16:56:53.087+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:56:53.188+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:53.188+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:53.188+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Action: " id=63938011 action="&{Type:Create Timestamp:2025-05-04 16:56:53.188216 +0300 EEST m=+5.279983667 Subject:Id: 63938011, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt, Mode: 644 Events:[0x1400007f7c0] Properties:map[]}"
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:394: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt, Props=map[]
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Received fsnotify event" op=CHMOD name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Queuing event" type=CHMOD
time=2025-05-04T16:56:54.088+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Stating event file" operation=Chmod path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Popped event" operation=Chmod path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Chmod: File found on disk, check it in watchmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Chmod: File is zero size. It wasn't before." path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Chmod: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Chmod: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Action: " id=63938011 action="&{Type:Write Timestamp:2025-05-04 16:56:54.088175 +0300 EEST m=+6.179943001 Subject:Id: 63938011, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt, Mode: 644 Events:[0x1400007f940] Properties:map[]}"
time=2025-05-04T16:56:55.088+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:401: Received expected action: Type=Write, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1937130119/watch/clear_file.txt, Props=map[]
    fsbroker_test.go:404: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/RenameFileInplace
time=2025-05-04T16:56:55.290+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:56:55.392+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:55.392+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:55.392+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Action: " id=63938110 action="&{Type:Create Timestamp:2025-05-04 16:56:55.392098 +0300 EEST m=+7.483866542 Subject:Id: 63938110, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt, Mode: 644 Events:[0x1400043a180] Properties:map[]}"
time=2025-05-04T16:56:56.291+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:418: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt, Props=map[]
time=2025-05-04T16:56:56.292+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt
time=2025-05-04T16:56:56.292+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:56.292+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:56.292+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:56:56.292+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:56.292+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Rename: Found watchmap entry" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Rename: Added Remove action to actionsmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Rename: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Create: Entry found in watchmap. This is a rename/move" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Create: Added action to renamedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Create: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Action: " id=63938110 action="&{Type:Rename Timestamp:2025-05-04 16:56:56.292239 +0300 EEST m=+8.384007959 Subject:Id: 63938110, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt, Mode: 644 Events:[0x1400007fbc0 0x1400007fb80] Properties:map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt]}"
time=2025-05-04T16:56:57.292+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:425: Received expected action: Type=Rename, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/new_name.txt, Props=map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_921209000/watch/old_name.txt]
    fsbroker_test.go:431: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/MoveFileWatchedToWatched
time=2025-05-04T16:56:57.499+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:56:57.600+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir
time=2025-05-04T16:56:57.600+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:57.600+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:58.499+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Action: " id=63938133 action="&{Type:Create Timestamp:2025-05-04 16:56:57.600831 +0300 EEST m=+9.692599792 Subject:Id: 63938133, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir, Mode: 20000000755 Events:[0x140003ccf40] Properties:map[]}"
time=2025-05-04T16:56:58.500+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:444: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir, Props=map[]
time=2025-05-04T16:56:59.001+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:56:59.001+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:56:59.001+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Action: " id=63938141 action="&{Type:Create Timestamp:2025-05-04 16:56:59.001884 +0300 EEST m=+11.093653084 Subject:Id: 63938141, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt, Mode: 644 Events:[0x140003cd0c0] Properties:map[]}"
time=2025-05-04T16:56:59.500+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:455: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt, Props=map[]
time=2025-05-04T16:57:00.052+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt
time=2025-05-04T16:57:00.052+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:00.052+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.052+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:57:00.052+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:00.052+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:00.499+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt
time=2025-05-04T16:57:00.499+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.499+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.499+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.499+03:00 level=DEBUG msg="Rename: Found watchmap entry" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Rename: Added Remove action to actionsmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Rename: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Create: Entry found in watchmap. This is a rename/move" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Create: Added action to renamedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Create: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Action: " id=63938141 action="&{Type:Rename Timestamp:2025-05-04 16:57:00.052767 +0300 EEST m=+12.144536376 Subject:Id: 63938141, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt, Mode: 644 Events:[0x14000682e40 0x14000682e00] Properties:map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt]}"
time=2025-05-04T16:57:00.500+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:466: Received expected action: Type=Rename, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/subdir/move_me.txt, Props=map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_801042854/watch/move_me.txt]
    fsbroker_test.go:472: [VerifyMap] ✓ Map state matches expected filesystem state (2 entries).
=== RUN   TestFSBrokerIntegration/MoveFileUnwatchedToWatched
time=2025-05-04T16:57:00.703+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:00.859+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt
time=2025-05-04T16:57:00.859+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:00.859+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Action: " id=63938147 action="&{Type:Create Timestamp:2025-05-04 16:57:00.859502 +0300 EEST m=+12.951271417 Subject:Id: 63938147, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt, Mode: 644 Events:[0x140003583c0] Properties:map[]}"
time=2025-05-04T16:57:01.704+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:496: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1364361113/watch/external.txt, Props=map[]
    fsbroker_test.go:499: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/MoveFileWatchedToUnwatched
time=2025-05-04T16:57:01.907+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:02.008+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:02.008+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:02.008+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Action: " id=63938154 action="&{Type:Create Timestamp:2025-05-04 16:57:02.008695 +0300 EEST m=+14.100465084 Subject:Id: 63938154, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt, Mode: 644 Events:[0x1400025a4c0] Properties:map[]}"
time=2025-05-04T16:57:02.907+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:514: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt, Props=map[]
time=2025-05-04T16:57:03.409+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.409+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:57:03.409+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Rename: Found watchmap entry" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Rename: Added Remove action to actionsmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Rename: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Action: " id=63938154 action="&{Type:Remove Timestamp:2025-05-04 16:57:03.409084 +0300 EEST m=+15.500854751 Subject:Id: 63938154, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt, Mode: 644 Events:[0x140004d4340] Properties:map[]}"
time=2025-05-04T16:57:03.907+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:523: Received expected action: Type=Remove, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3279959080/watch/internal.txt, Props=map[]
    fsbroker_test.go:526: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/HardDeleteFile
time=2025-05-04T16:57:04.111+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:04.211+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:04.211+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:04.211+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Action: " id=63938313 action="&{Type:Create Timestamp:2025-05-04 16:57:04.211751 +0300 EEST m=+16.303522292 Subject:Id: 63938313, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt, Mode: 644 Events:[0x1400007fd00] Properties:map[]}"
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:538: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt, Props=map[]
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Received fsnotify event" op=REMOVE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Queuing event" type=REMOVE
time=2025-05-04T16:57:05.112+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Stating event file" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="File not found" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Popped event" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Remove: Found watchmap entry." path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Remove: Added action to removedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Remove: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Action: " id=63938313 action="&{Type:Remove Timestamp:2025-05-04 16:57:05.1125 +0300 EEST m=+17.204270709 Subject:Id: 63938313, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt, Mode: 644 Events:[0x1400062b600] Properties:map[]}"
time=2025-05-04T16:57:06.112+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:545: Received expected action: Type=Remove, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3203470081/watch/delete_me.txt, Props=map[]
    fsbroker_test.go:548: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/CreateDirectory
time=2025-05-04T16:57:06.314+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:06.415+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir
time=2025-05-04T16:57:06.415+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:06.415+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:07.315+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir
time=2025-05-04T16:57:07.315+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir
time=2025-05-04T16:57:07.315+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir
time=2025-05-04T16:57:07.315+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:07.316+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir
time=2025-05-04T16:57:07.316+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir
time=2025-05-04T16:57:07.316+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:07.316+03:00 level=DEBUG msg="Action: " id=63938433 action="&{Type:Create Timestamp:2025-05-04 16:57:06.415467 +0300 EEST m=+18.507238792 Subject:Id: 63938433, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir, Mode: 20000000755 Events:[0x1400059a880] Properties:map[]}"
time=2025-05-04T16:57:07.316+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:563: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3297734930/watch/new_dir, Props=map[]
    fsbroker_test.go:566: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/RenameDirectoryInplace
time=2025-05-04T16:57:07.518+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:07.620+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:07.620+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:07.620+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:08.519+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:08.519+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:08.519+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:08.519+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:08.520+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:08.520+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:08.520+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:08.520+03:00 level=DEBUG msg="Action: " id=63938482 action="&{Type:Create Timestamp:2025-05-04 16:57:07.620241 +0300 EEST m=+19.712012667 Subject:Id: 63938482, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir, Mode: 20000000755 Events:[0x140004d5280] Properties:map[]}"
time=2025-05-04T16:57:08.520+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:580: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir, Props=map[]
time=2025-05-04T16:57:08.521+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir
time=2025-05-04T16:57:08.521+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:08.521+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:08.521+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:57:08.521+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:08.521+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Rename: Found watchmap entry" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Rename: Added Remove action to actionsmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Rename: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Create: Entry found in watchmap. This is a rename/move" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir
time=2025-05-04T16:57:09.519+03:00 level=DEBUG msg="Create: Added action to renamedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir
time=2025-05-04T16:57:09.520+03:00 level=DEBUG msg="Create: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir
time=2025-05-04T16:57:09.520+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:09.520+03:00 level=DEBUG msg="Action: " id=63938482 action="&{Type:Rename Timestamp:2025-05-04 16:57:08.52145 +0300 EEST m=+20.613221667 Subject:Id: 63938482, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir, Mode: 20000000755 Events:[0x14000682080 0x14000682040] Properties:map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir]}"
time=2025-05-04T16:57:09.520+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:587: Received expected action: Type=Rename, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/new_dir, Props=map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_991079878/watch/old_dir]
    fsbroker_test.go:593: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/MoveDirectoryWatchedToWatched
time=2025-05-04T16:57:09.737+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:09.849+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir
time=2025-05-04T16:57:09.849+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:09.849+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Action: " id=63938493 action="&{Type:Create Timestamp:2025-05-04 16:57:09.849806 +0300 EEST m=+21.941578626 Subject:Id: 63938493, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir, Mode: 20000000755 Events:[0x1400062a200] Properties:map[]}"
time=2025-05-04T16:57:10.738+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:606: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir, Props=map[]
time=2025-05-04T16:57:11.242+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:11.242+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:11.242+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:11.738+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:11.738+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:11.738+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:11.738+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:11.739+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:11.739+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:11.739+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:11.739+03:00 level=DEBUG msg="Action: " id=63938494 action="&{Type:Create Timestamp:2025-05-04 16:57:11.242801 +0300 EEST m=+23.334574167 Subject:Id: 63938494, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir, Mode: 20000000755 Events:[0x1400007e080] Properties:map[]}"
time=2025-05-04T16:57:11.739+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:616: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir, Props=map[]
time=2025-05-04T16:57:12.291+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir
time=2025-05-04T16:57:12.291+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:12.291+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.291+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:57:12.303+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:12.303+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Rename: Found watchmap entry" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Rename: Added Remove action to actionsmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Rename: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Create: Entry found in watchmap. This is a rename/move" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Create: Added action to renamedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Create: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Action: " id=63938494 action="&{Type:Rename Timestamp:2025-05-04 16:57:12.291335 +0300 EEST m=+24.383108626 Subject:Id: 63938494, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir, Mode: 20000000755 Events:[0x140004d40c0 0x140004d4080] Properties:map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir]}"
time=2025-05-04T16:57:12.738+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:626: Received expected action: Type=Rename, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/parent_dir/move_this_dir, Props=map[OldPath:/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1164158210/watch/move_this_dir]
    fsbroker_test.go:632: [VerifyMap] ✓ Map state matches expected filesystem state (2 entries).
=== RUN   TestFSBrokerIntegration/MoveDirectoryUnwatchedToWatched
time=2025-05-04T16:57:12.979+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:13.102+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir
time=2025-05-04T16:57:13.102+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:13.115+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:13.979+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir
time=2025-05-04T16:57:13.979+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir
time=2025-05-04T16:57:13.979+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir
time=2025-05-04T16:57:13.979+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:13.980+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir
time=2025-05-04T16:57:13.980+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir
time=2025-05-04T16:57:13.980+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:13.980+03:00 level=DEBUG msg="Action: " id=63938497 action="&{Type:Create Timestamp:2025-05-04 16:57:13.102115 +0300 EEST m=+25.193887959 Subject:Id: 63938497, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir, Mode: 20000000755 Events:[0x1400059a040] Properties:map[]}"
time=2025-05-04T16:57:13.980+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:652: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1151883209/watch/external_dir, Props=map[]
    fsbroker_test.go:655: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/MoveDirectoryWatchedToUnwatched
time=2025-05-04T16:57:14.244+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:14.373+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:14.373+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:14.373+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Action: " id=63938501 action="&{Type:Create Timestamp:2025-05-04 16:57:14.373842 +0300 EEST m=+26.465616001 Subject:Id: 63938501, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir, Mode: 20000000755 Events:[0x1400062a280] Properties:map[]}"
time=2025-05-04T16:57:15.266+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:669: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir, Props=map[]
time=2025-05-04T16:57:15.873+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:15.888+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:57:15.889+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Rename: Found watchmap entry" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Rename: Added Remove action to actionsmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Rename: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Action: " id=63938501 action="&{Type:Remove Timestamp:2025-05-04 16:57:15.888927 +0300 EEST m=+27.980700751 Subject:Id: 63938501, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir, Mode: 20000000755 Events:[0x14000714000] Properties:map[]}"
time=2025-05-04T16:57:16.246+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:679: Received expected action: Type=Remove, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1073062380/watch/internal_dir, Props=map[]
    fsbroker_test.go:682: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/HardDeleteDirectory
time=2025-05-04T16:57:16.504+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:16.583+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:16.583+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:16.583+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:17.524+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:17.524+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:17.524+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:17.524+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:17.525+03:00 level=DEBUG msg="Create: Added recursive watch for directory" signature=Create-/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:17.525+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:17.525+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:17.525+03:00 level=DEBUG msg="Action: " id=63938536 action="&{Type:Create Timestamp:2025-05-04 16:57:16.583091 +0300 EEST m=+28.674865417 Subject:Id: 63938536, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir, Mode: 20000000755 Events:[0x1400059a340] Properties:map[]}"
time=2025-05-04T16:57:17.525+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:701: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir, Props=map[]
time=2025-05-04T16:57:18.068+03:00 level=DEBUG msg="Received fsnotify event" op=REMOVE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir/inner_file.txt
time=2025-05-04T16:57:18.083+03:00 level=DEBUG msg="Queuing event" type=REMOVE
time=2025-05-04T16:57:18.083+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
    fsbroker_test.go:711: Waiting for first Remove action.after RemoveAll(/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir)
time=2025-05-04T16:57:18.108+03:00 level=DEBUG msg="Received fsnotify event" op=REMOVE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.121+03:00 level=DEBUG msg="Queuing event" type=REMOVE
time=2025-05-04T16:57:18.121+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Stating event file" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir/inner_file.txt
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="File not found" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir/inner_file.txt
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Stating event file" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="File not found" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Popped event" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Remove: Found watchmap entry." path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Remove: Added action to removedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Remove: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Popped event" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir/inner_file.txt
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Remove: No watchmap entry found, file must have been created then removed quickly" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir/inner_file.txt
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Remove: Added action to noop" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir/inner_file.txt
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Action: " id=63938536 action="&{Type:Remove Timestamp:2025-05-04 16:57:18.10853 +0300 EEST m=+30.200304751 Subject:Id: 63938536, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir, Mode: 20000000755 Events:[0x140006820c0] Properties:map[]}"
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="NoOp: " action="&{Type:NoOp Timestamp:2025-05-04 16:57:18.08378 +0300 EEST m=+30.175555167 Subject:<nil> Events:[0x14000358040] Properties:map[]}"
    fsbroker_test.go:739: Received first remove action. Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_3331457798/watch/delete_this_dir
    fsbroker_test.go:756: Received Remove action.path 'delete_this_dir' matches expected paths ('delete_this_dir' or 'delete_this_dir/inner_file.txt')
    fsbroker_test.go:761: Draining potential subsequent Remove action...
time=2025-05-04T16:57:18.507+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:19.528+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:766: Checking for further unexpected action....
time=2025-05-04T16:57:20.505+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:767: Correctly received no non-NoOp action or error within 500ms
    fsbroker_test.go:770: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/IgnoreHiddenFile
time=2025-05-04T16:57:20.802+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test_posix.go:14: Skipping setHiddenAttribute on non-Windows platform for /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_605633895/.hidden_external
time=2025-05-04T16:57:20.954+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_605633895/watch/.hidden_external
time=2025-05-04T16:57:20.954+03:00 level=DEBUG msg="Ignoring event: Hidden file" name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_605633895/watch/.hidden_external
time=2025-05-04T16:57:21.838+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:803: Correctly received no non-NoOp action or error within 1.5s
    fsbroker_test.go:197: [VerifyMap] Ignoring hidden file on disk: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_605633895/watch/.hidden_external
    fsbroker_test.go:806: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/IgnoreSystemFile
time=2025-05-04T16:57:22.634+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:22.739+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_583646922/watch/.DS_Store
time=2025-05-04T16:57:22.753+03:00 level=DEBUG msg="Ignoring event: Hidden file" name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_583646922/watch/.DS_Store
time=2025-05-04T16:57:23.647+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:835: Correctly received no non-NoOp action or error within 1.5s
    fsbroker_test.go:197: [VerifyMap] Ignoring hidden file on disk: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_583646922/watch/.DS_Store
    fsbroker_test.go:838: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/WriteDeduplication
time=2025-05-04T16:57:24.527+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:24.678+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:24.678+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:24.678+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Action: " id=63938643 action="&{Type:Create Timestamp:2025-05-04 16:57:24.678613 +0300 EEST m=+36.770389834 Subject:Id: 63938643, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt, Mode: 644 Events:[0x1400062a400] Properties:map[]}"
time=2025-05-04T16:57:25.572+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:856: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt, Props=map[]
    fsbroker_test.go:859: Performing rapid writes...
time=2025-05-04T16:57:25.603+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.623+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:25.623+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.623+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:25.625+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:25.625+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:25.701+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.701+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:25.701+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=3
time=2025-05-04T16:57:25.721+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.721+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:25.721+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:25.721+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:25.741+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=4
time=2025-05-04T16:57:25.741+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=5
    fsbroker_test.go:873: Finished rapid writes.
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Stating event file" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Found watchmap entry. This is a normal write" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Found watchmap entry. This is a normal write" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Found watchmap entry. This is a normal write" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Found watchmap entry. This is a normal write" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Found watchmap entry. This is a normal write" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Added action to writtenmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Write: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Action: " id=63938643 action="&{Type:Write Timestamp:2025-05-04 16:57:25.721564 +0300 EEST m=+37.813340626 Subject:Id: 63938643, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt, Mode: 644 Events:[0x14000714080 0x14000714040 0x1400059a680 0x14000358140 0x14000358100] Properties:map[]}"
time=2025-05-04T16:57:26.546+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:876: Received expected action: Type=Write, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_170794052/watch/dedup_write.txt, Props=map[]
    fsbroker_test.go:879: Correctly received no non-NoOp action or error within 666.666666ms
    fsbroker_test.go:882: [VerifyMap] ✓ Map state matches expected filesystem state (1 entries).
=== RUN   TestFSBrokerIntegration/DeleteDeduplication
time=2025-05-04T16:57:27.503+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:27.635+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:27.635+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:27.635+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Action: " id=63938647 action="&{Type:Create Timestamp:2025-05-04 16:57:27.635284 +0300 EEST m=+39.727061459 Subject:Id: 63938647, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt, Mode: 644 Events:[0x140004d4180] Properties:map[]}"
time=2025-05-04T16:57:28.521+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:900: Received expected action: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt, Props=map[]
    fsbroker_test.go:903: Performing rapid write then delete...
    fsbroker_test.go:919: Finished rapid write then delete.
time=2025-05-04T16:57:28.580+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:28.580+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:28.580+03:00 level=DEBUG msg="Received fsnotify event" op=REMOVE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:28.580+03:00 level=DEBUG msg="Queuing event" type=REMOVE
time=2025-05-04T16:57:28.593+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:28.593+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:29.525+03:00 level=DEBUG msg="Stating event file" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.525+03:00 level=DEBUG msg="File not found" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.525+03:00 level=DEBUG msg="Stating event file" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="File not found" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Popped event" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Remove: Found watchmap entry." path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Remove: Added action to removedmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Remove: Done" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Write: File no longer exists" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Write: Added action to noop" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Action: " id=63938647 action="&{Type:Remove Timestamp:2025-05-04 16:57:28.580145 +0300 EEST m=+40.671923001 Subject:Id: 63938647, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt, Mode: 644 Events:[0x1400007e100] Properties:map[]}"
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="NoOp: " action="&{Type:NoOp Timestamp:2025-05-04 16:57:28.58013 +0300 EEST m=+40.671907834 Subject:<nil> Events:[0x1400007e0c0] Properties:map[Message:Event irrelevant. File no longer exists]}"
    fsbroker_test.go:922: Received expected action: Type=Remove, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_1152440927/watch/dedup_delete.txt, Props=map[]
    fsbroker_test.go:925: Received and ignored NoOp action during expectNoEvent check (subject is nil)
time=2025-05-04T16:57:29.526+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:925: Correctly received no non-NoOp action or error within 666.666666ms
    fsbroker_test.go:928: [VerifyMap] ✓ Map state matches expected filesystem state (0 entries).
=== RUN   TestFSBrokerIntegration/MixedRapidActions
time=2025-05-04T16:57:30.470+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:946: Performing mixed rapid actions...
time=2025-05-04T16:57:30.606+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:30.606+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:30.606+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:30.606+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:30.630+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=1
time=2025-05-04T16:57:30.630+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=2
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Received fsnotify event" op=CREATE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Queuing event" type=CREATE
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=3
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=4
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Received fsnotify event" op=RENAME name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Queuing event" type=RENAME
time=2025-05-04T16:57:30.645+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=5
time=2025-05-04T16:57:30.680+03:00 level=DEBUG msg="Received fsnotify event" op=WRITE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:30.680+03:00 level=DEBUG msg="Queuing event" type=WRITE
time=2025-05-04T16:57:30.680+03:00 level=DEBUG msg="Received fsnotify event" op=REMOVE name=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:30.680+03:00 level=DEBUG msg="Queuing event" type=REMOVE
time=2025-05-04T16:57:30.690+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=6
time=2025-05-04T16:57:30.690+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=7
    fsbroker_test.go:957: Finished mixed rapid actions.
    fsbroker_test.go:960: Collecting action....
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="File not found" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Stating event file" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="File not found" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Stating event file" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="File not found" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Stating event file" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="File not found" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Remove path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Remove: No watchmap entry found, file must have been created then removed quickly" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Remove: Added action to noop" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Write path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Write: No entry found in watchmap. This is a non-empty file creation" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Write: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Rename path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Rename: No watchmap entry found, file must have been created then renamed quickly" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Rename: Added action to noop" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Since file no longer exists on disk, this event is irrelevant" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Added action to noop" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_c.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: No entry found in watchmap. This is a new path" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Adding watch if recursive watch is enabled"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Added action to createdmap" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Popped event" operation=Create path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Since file no longer exists on disk, this event is irrelevant" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Create: Added action to noop" path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a.txt
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Pass 2: Emitting actions"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Action: " id=63938655 action="&{Type:Create Timestamp:2025-05-04 16:57:30.680141 +0300 EEST m=+42.771919501 Subject:Id: 63938655, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt, Mode: 644 Events:[0x1400007e440 0x140004d42c0] Properties:map[]}"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Action: " id=63938654 action="&{Type:Create Timestamp:2025-05-04 16:57:30.645209 +0300 EEST m=+42.736987001 Subject:Id: 63938654, Path: /var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt, Mode: 644 Events:[0x1400007e240] Properties:map[]}"
    fsbroker_test.go:977: Collected Event: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_b.txt, OldPath=<nil>
    fsbroker_test.go:977: Collected Event: Type=Create, Path=/var/folders/5z/yys8by895g3gnzwdv4p3syt40000gn/T/fsbroker_test_44466892/watch/file_a_renamed.txt, OldPath=<nil>
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="NoOp: " action="&{Type:NoOp Timestamp:2025-05-04 16:57:30.680161 +0300 EEST m=+42.771939334 Subject:<nil> Events:[0x1400007e480] Properties:map[]}"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="NoOp: " action="&{Type:NoOp Timestamp:2025-05-04 16:57:30.645341 +0300 EEST m=+42.737119292 Subject:<nil> Events:[0x1400007e3c0] Properties:map[]}"
    fsbroker_test.go:972: Ignoring NoOp action during collection (subject is nil)
    fsbroker_test.go:972: Ignoring NoOp action during collection (subject is nil)
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="NoOp: " action="&{Type:NoOp Timestamp:2025-05-04 16:57:30.645229 +0300 EEST m=+42.737007084 Subject:<nil> Events:[0x1400007e280] Properties:map[Message:Event irrelevant. File no longer exists]}"
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="NoOp: " action="&{Type:NoOp Timestamp:2025-05-04 16:57:30.606737 +0300 EEST m=+42.698515209 Subject:<nil> Events:[0x140004d4280] Properties:map[Message:Event irrelevant. File no longer exists]}"
    fsbroker_test.go:972: Ignoring NoOp action during collection (subject is nil)
    fsbroker_test.go:972: Ignoring NoOp action during collection (subject is nil)
time=2025-05-04T16:57:31.488+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
time=2025-05-04T16:57:32.479+03:00 level=DEBUG msg="Event loop tick" "Stack Size"=0
    fsbroker_test.go:987: Finished collecting action after 2.5s. Got 2 action(s).
    fsbroker_test.go:1019: [VerifyMap] ✓ Map state matches expected filesystem state (2 entries).
--- PASS: TestFSBrokerIntegration (45.46s)
    --- PASS: TestFSBrokerIntegration/CreateEmptyFile (1.20s)
    --- PASS: TestFSBrokerIntegration/CreateNonEmptyFile (1.71s)
    --- PASS: TestFSBrokerIntegration/ModifyFile (2.20s)
    --- PASS: TestFSBrokerIntegration/ClearFile (2.20s)
    --- PASS: TestFSBrokerIntegration/RenameFileInplace (2.21s)
    --- PASS: TestFSBrokerIntegration/MoveFileWatchedToWatched (3.20s)
    --- PASS: TestFSBrokerIntegration/MoveFileUnwatchedToWatched (1.20s)
    --- PASS: TestFSBrokerIntegration/MoveFileWatchedToUnwatched (2.20s)
    --- PASS: TestFSBrokerIntegration/HardDeleteFile (2.20s)
    --- PASS: TestFSBrokerIntegration/CreateDirectory (1.20s)
    --- PASS: TestFSBrokerIntegration/RenameDirectoryInplace (2.20s)
    --- PASS: TestFSBrokerIntegration/MoveDirectoryWatchedToWatched (3.22s)
    --- PASS: TestFSBrokerIntegration/MoveDirectoryUnwatchedToWatched (1.27s)
    --- PASS: TestFSBrokerIntegration/MoveDirectoryWatchedToUnwatched (2.27s)
    --- PASS: TestFSBrokerIntegration/HardDeleteDirectory (4.30s)
    --- PASS: TestFSBrokerIntegration/IgnoreHiddenFile (1.84s)
    --- PASS: TestFSBrokerIntegration/IgnoreSystemFile (1.89s)
    --- PASS: TestFSBrokerIntegration/WriteDeduplication (2.98s)
    --- PASS: TestFSBrokerIntegration/DeleteDeduplication (2.97s)
    --- PASS: TestFSBrokerIntegration/MixedRapidActions (2.98s)
PASS
ok  	github.com/helshabini/fsbroker	45.963s
